(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}})();const w="/wdd330-final-project/",y=async(n,e)=>{const o=document.getElementById(n);if(o)try{const t=await(await fetch(`${w}partials/${e}`)).text();o.innerHTML=t}catch(s){console.error(`Error loading partial ${e}:`,s)}},b=async()=>{await y("header","header.html"),await y("footer","footer.html")},c=(n="Something went wrong")=>{const e=document.createElement("div");e.classList.add("error"),e.textContent=n,document.body.prepend(e),setTimeout(()=>{e.classList.add("show")},10),setTimeout(()=>{e.classList.remove("show"),e.classList.add("hide")},3e3),setTimeout(()=>{e.remove()},3500)};class S{constructor(e){this.apiKey=e,this.baseUrl="https://api.themoviedb.org/3",this.imageBaseUrl="https://image.tmdb.org/t/p/w500"}async getTrendingMovies(){try{const e=`${this.baseUrl}/trending/movie/week?api_key=${this.apiKey}`,o=await fetch(e);return o.ok?(await o.json()).results:(c("Failed to fetch trending movies."),[])}catch(e){return console.error("Error fetching trending movies:",e),c("Failed to load trending movies."),[]}}async getGenres(){try{const e=await fetch(`https://api.themoviedb.org/3/genre/movie/list?api_key=${this.apiKey}&language=en-US`);return e.ok?(await e.json()).genres:(c("Failed to fetch genres."),[])}catch(e){return console.error("Error fetching genres:",e),c("Failed to load genres."),[]}}}b();const v="241e6becbd9e2bd9505a83f840487126",g=new S(v),p=await g.getTrendingMovies(),M=async n=>{const e=document.querySelector("template"),o=document.getElementById("movies-container");if(!n||n.length===0){o.innerHTML="<p>No movies found.</p>";return}const s=await g.getGenres(),t=Object.fromEntries(s.map(r=>[r.id,r.name]));n.forEach(r=>{const a=e.content.cloneNode(!0),l=a.querySelector("h1"),d=a.querySelector("#container"),m=a.querySelector("p"),u=r.genre_ids.map(f=>t[f]),i=r.release_date?new Date(r.release_date).getFullYear():"N/A";m.textContent=`${i} | ${u.join(", ")}`,d.style.backgroundImage=`url(https://image.tmdb.org/t/p/w500${r.poster_path})`,l.textContent=r.title,o.appendChild(a)})},h=async n=>{if(!n||n.length===0)return;const e=await g.getGenres(),o=Object.fromEntries(e.map(i=>[i.id,i.name])),s=Math.floor(Math.random()*n.length),t=n[s],r=t.genre_ids.map(i=>o[i]),a=document.getElementById("random-movie"),l=a.querySelector("img"),d=a.querySelector("h1"),m=a.querySelector("p"),u=t.release_date?new Date(t.release_date).getFullYear():"N/A";l.src=`https://image.tmdb.org/t/p/original${t.backdrop_path}`,d.textContent=t.title,m.innerHTML=`${u} | ${r.join(", ")} | <span class="flex items-center gap-1"><img src="/assets/star.svg" class="size-5" alt="Rating" /> ${t.vote_average.toFixed(1)}</span>`};M(p);h(p);setInterval(()=>{const n=document.getElementById("random-movie");n.querySelector("#animation").style.animationPlayState="paused",n.querySelector("img").style.animationPlayState="paused",h(p),n.querySelector("img").style.animationPlayState="running",n.querySelector("#animation").style.animationPlayState="running"},3e3);
